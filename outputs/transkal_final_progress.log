[2026-01-05 14:22:46] ============================================================
[2026-01-05 14:22:46] TransKal Final Training and Evaluation
[2026-01-05 14:22:46] ============================================================
[2026-01-05 14:22:46] ðŸ”¬ FULL MODE (100% data, up to 100 epochs)
[2026-01-05 14:22:46] Using FULL mode hyperparameters
[2026-01-05 14:22:46] Hyperparameters: {'sequence_length': 40, 'nhead': 4, 'd_model': 32, 'num_layers': 2, 'dropout': 0.19500665626358132, 'learning_rate': 0.0004276034493703387, 'batch_size': 64, 'kalman_Q': 5.0369063680311206e-05, 'kalman_R': 0.022250707355345557}
[2026-01-05 14:22:46] ============================================================
[2026-01-05 14:22:50] âœ“ Using device: cuda
[2026-01-05 14:23:05] âœ“ Train: (864000, 57)
[2026-01-05 14:23:05] âœ“ Val: (432000, 57)
[2026-01-05 14:23:05] âœ“ Test: (2880000, 57)
[2026-01-05 14:23:05] âœ“ Data loading time: 14.71s
[2026-01-05 14:23:05] âœ“ Number of features: 52
[2026-01-05 14:23:05] âœ“ Number of classes: 18
[2026-01-05 14:23:05] âœ“ Model and dataset classes defined
[2026-01-05 14:23:25] âœ“ Train dataset: 793800 windows
[2026-01-05 14:23:25] âœ“ Val dataset: 396900 windows
[2026-01-05 14:23:25] âœ“ Test dataset: 2739600 windows
[2026-01-05 14:23:25] âœ“ Dataset creation time: 19.62s
[2026-01-05 14:23:26] Training for up to 100 epochs with patience 10...
[2026-01-05 14:25:12] Epoch 1/100: Train Loss = 0.168512, Val Loss = 0.043658
[2026-01-05 14:32:03] Epoch 5/100: Train Loss = 0.030582, Val Loss = 0.039970
[2026-01-05 14:40:34] Epoch 10/100: Train Loss = 0.025214, Val Loss = 0.048689
[2026-01-05 14:48:55] Epoch 15/100: Train Loss = 0.021303, Val Loss = 0.036857
[2026-01-05 14:55:18] Early stopping at epoch 19
[2026-01-05 14:55:18] âœ“ Best epoch: 9 (val_loss = 0.035201)
[2026-01-05 15:01:45] âœ“ Saved confusion matrix to ../outputs/figures/transkal_confusion_matrix.png
[2026-01-05 15:01:46] âœ“ Saved metrics to ../outputs/metrics/transkal_metrics.json
[2026-01-05 15:01:46] âœ“ Saved model to ../outputs/models/transkal_final.pt
[2026-01-05 15:01:46] âœ“ Saved confusion matrix to ../outputs/metrics/transkal_confusion_matrix.csv
[2026-01-05 15:01:46] âœ“ TransKal Final Training Complete! 
[2026-01-05 15:01:46] Total runtime: 38m 59s
[2026-01-05 15:01:46] Best epoch: 9
[2026-01-05 15:01:46] Test Accuracy: 0.9909
[2026-01-05 15:01:46] Test F1 (weighted): 0.9909
